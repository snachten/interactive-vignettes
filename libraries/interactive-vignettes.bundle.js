!function(e){var n={};function t(s){if(n[s])return n[s].exports;var i=n[s]={i:s,l:!1,exports:{}};return e[s].call(i.exports,i,i.exports,t),i.l=!0,i.exports}t.m=e,t.c=n,t.d=function(e,n,s){t.o(e,n)||Object.defineProperty(e,n,{enumerable:!0,get:s})},t.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},t.t=function(e,n){if(1&n&&(e=t(e)),8&n)return e;if(4&n&&"object"==typeof e&&e&&e.__esModule)return e;var s=Object.create(null);if(t.r(s),Object.defineProperty(s,"default",{enumerable:!0,value:e}),2&n&&"string"!=typeof e)for(var i in e)t.d(s,i,function(n){return e[n]}.bind(null,i));return s},t.n=function(e){var n=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(n,"a",n),n},t.o=function(e,n){return Object.prototype.hasOwnProperty.call(e,n)},t.p="",t(t.s=0)}([function(e,n,t){e.exports=t(1)},function(e,n,t){"use strict";function s(e,n){for(var t=0;t<n.length;t++){var s=n[t];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(e,s.key,s)}}t.r(n);var i=function(){function e(){!function(e,n){if(!(e instanceof n))throw new TypeError("Cannot call a class as a function")}(this,e),this._total_assets_to_load=0,this._loaded_images=0,this._images={},this._image_sequences={},this._sounds={}}return function(e,n,t){n&&s(e.prototype,n),t&&s(e,t)}(e,[{key:"load_image",value:function(e,n){this._total_assets_to_load++,this._images[e]=loadImage("./assets/images/"+e+"."+n,this.asset_loaded.bind(this))}},{key:"load_image_sequence",value:function(e,n,t){this._total_assets_to_load+=t,this._image_sequences[e]=[];for(var s=0;s<t;++s)this._image_sequences[e][s]=loadImage("assets/images/"+e+"/"+e+"_"+s+"."+n,this.asset_loaded.bind(this))}},{key:"load_sound",value:function(e,n){this._total_assets_to_load++,this._sounds[e]=loadSound("./assets/sounds/"+e+"."+n,this.asset_loaded.bind(this))}},{key:"draw_image",value:function(e,n,t){image(this._images[e],n,t)}},{key:"draw_image_from_sequence",value:function(e,n,t,s){image(this._image_sequences[e][s],n,t)}},{key:"play_sound",value:function(e){this._sounds[e].play()}},{key:"stop_sound",value:function(e){this._sounds[e].isPlaying()&&this._sounds[e].stop()}},{key:"all_assets_loaded",value:function(){return this._loaded_images>=this._total_assets_to_load}},{key:"asset_loaded",value:function(){this._loaded_images++}}]),e}();function o(e,n){for(var t=0;t<n.length;t++){var s=n[t];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(e,s.key,s)}}var _=function(){function e(n){!function(e,n){if(!(e instanceof n))throw new TypeError("Cannot call a class as a function")}(this,e),this._scenes=[],this._asset_loader=new i,this._current_scene=0,this._recording=!1,this._scale_to_screen=!1,this._lock_scale=!1,this._size=n}return function(e,n,t){n&&o(e.prototype,n),t&&o(e,t)}(e,[{key:"add_scene",value:function(e){this._scenes.push(e)}},{key:"scale_to_screen",value:function(e){this._scale_to_screen=e,e?(this.resize(),this.start_resizing()):this.stop_resizing()}},{key:"resize",value:function(){if(!this._lock_scale&&this._scale_to_screen){var e=(window.innerWidth+0)/this._size.x,n=(window.innerHeight+0)/this._size.y;setup_new_canvas(min(e,n)*this._size.x,min(e,n)*this._size.y)}}},{key:"start_resizing",value:function(){window.addEventListener("resize",this.resize.bind(this))}},{key:"stop_resizing",value:function(){window.removeEventListener("resize",this.scale_to_screen.bind(this))}},{key:"draw",value:function(){push(),scale(this.current_scale),this._scenes.length>0&&this._asset_loader.all_assets_loaded()&&this._scenes[this._current_scene].draw(),this._recording&&this.capture_frame(),pop()}},{key:"click",value:function(){this._scenes.length>0&&this._scenes[this._current_scene].click()}},{key:"mouse_pressed",value:function(){this.scale_mouse(),this._scenes.length>0&&this._scenes[this._current_scene].mouse_pressed()}},{key:"mouse_released",value:function(){this._scenes.length>0&&this._scenes[this._current_scene].mouse_released()}},{key:"mouse_moved",value:function(){this.scale_mouse(),this._scenes.length>0&&this._scenes[this._current_scene].mouse_moved()}},{key:"mouse_dragged",value:function(){this.scale_mouse(),this._scenes.length>0&&this._scenes[this._current_scene].mouse_dragged()}},{key:"scale_mouse",value:function(){mouseX*=1/this.current_scale,mouseY*=1/this.current_scale}},{key:"manually_change_scenes",value:function(e){this._manually_change_scenes=e}},{key:"go_to_scene",value:function(e){this._current_scene=e-1}},{key:"key_pressed",value:function(){console.log(keyCode,key),"ArrowRight"!=key||this._manually_change_scenes?"ArrowLeft"!=key||this._manually_change_scenes?"r"!=key||this._recording?"r"==key&&this._recording?this.end_recording():this._scenes.length>0&&this._scenes[this._current_scene].key_pressed():this.begin_recording():this.decrement_current_scene():this.increment_current_scene()}},{key:"increment_current_scene",value:function(){this._current_scene=(this._current_scene+1)%this._scenes.length}},{key:"decrement_current_scene",value:function(){this._current_scene=this._current_scene-1,this._current_scene=this._current_scene<0?this._scenes.length-1:this._current_scene}},{key:"key_released",value:function(e){this._scenes[this._current_scene].key_released()}},{key:"begin_recording",value:function(){console.log("started recording"),this._lock_scale=!0,setup_new_canvas(this._size.x,this._size.y),ccapturer.start(),this.capture_frame(),this._recording=!0}},{key:"capture_frame",value:function(){ccapturer.capture(p5Canvas)}},{key:"end_recording",value:function(){console.log("finished recording"),ccapturer.stop(),ccapturer.save(),this._recording=!1,this._lock_scale=!1,this.resize()}},{key:"load_image",value:function(e,n){this._asset_loader.load_image(e,n)}},{key:"load_image_sequence",value:function(e,n,t){this._asset_loader.load_image_sequence(e,n,t)}},{key:"load_sound",value:function(e,n){this._asset_loader.load_sound(e,n)}},{key:"draw_image",value:function(e,n,t){this._asset_loader.draw_image(e,n,t)}},{key:"draw_image_from_sequence",value:function(e,n,t,s){this._asset_loader.draw_image_from_sequence(e,n,t,s)}},{key:"play_sound",value:function(e){this._asset_loader.play_sound(e)}},{key:"stop_sound",value:function(e){this._asset_loader.stop_sound(e)}},{key:"current_scale",get:function(){return this._lock_scale?1:p5Width/this._size.x}}]),e}();function u(e,n){for(var t=0;t<n.length;t++){var s=n[t];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(e,s.key,s)}}var c=function(){function e(n){!function(e,n){if(!(e instanceof n))throw new TypeError("Cannot call a class as a function")}(this,e),this._draw_function=n,this._click_function=function(){},this._mouse_moved_function=function(){},this._mouse_dragged_function=function(){},this._mouse_pressed_function=function(){},this._mouse_released_function=function(){},this._key_pressed_function=function(){},this._key_released_function=function(){},vignettes.add_scene(this)}return function(e,n,t){n&&u(e.prototype,n),t&&u(e,t)}(e,[{key:"draw",value:function(){this._draw_function()}},{key:"click",get:function(){return this._click_function},set:function(e){this._click_function=e}},{key:"mouse_pressed",get:function(){return this._mouse_pressed_function},set:function(e){this._mouse_pressed_function=e}},{key:"mouse_released",get:function(){return this._mouse_released_function},set:function(e){this._mouse_released_function=e}},{key:"mouse_moved",get:function(){return this._mouse_moved_function},set:function(e){this._mouse_moved_function=e}},{key:"mouse_dragged",get:function(){return this._mouse_dragged_function},set:function(e){this._mouse_dragged_function=e}},{key:"key_pressed",get:function(){return this._key_pressed_function},set:function(e){this._key_pressed_function=e}},{key:"key_released",get:function(){return this._key_released_function},set:function(e){this._key_released_function=e}}]),e}(),r={x:1280,y:720};window.setup=function(){angleMode(DEGREES),imageMode(CENTER);var e=new _(r);!function(e){window.vignettes=e,window.Scene=c,window.ccapturer=new CCapture({format:"webm",framerate:24})}(e),setup_new_canvas(r.x,r.y),setup_vignettes(e),setup_scenes(e)},window.draw=function(){background(255),vignettes.draw()},window.setup_new_canvas=function(e,n){window.p5Canvas=createCanvas(e,n).canvas,window.p5Width=width,window.p5Height=height,width=r.x,height=r.y},window.mouseClicked=function(){vignettes.click()},window.mousePressed=function(){vignettes.mouse_pressed()},window.mouseReleased=function(){vignettes.mouse_released()},window.mouseDragged=function(){vignettes.mouse_dragged()},window.mouseMoved=function(){vignettes.mouse_moved()},document.onkeydown=function(e){e.metaKey||e.preventDefault(),keyCode=e.keyCode,key=e.key,vignettes.key_pressed()},document.onkeyup=function(e){vignettes.key_released()}}]);